<!--
Copyright (c) The TwistedFTW Team
See LICENSE for details.
-->
<h1>Deferred</h1>

<p>
  Many articles on this site stand alone.  This one does not.  Please read <a href="#!/core/introduction">What is Twisted?</a> (especially "4. It's event-driven") before you read this one.
</p>


<h2>Registering callbacks</h2>

<p>
  Twisted is just Python, and event-driven programming is just plain old function calls.  Event-driven function calls are initiated by an event, such as bytes being received on the network.
</p>

<p>
  Sometimes you know that an event is going to happen that will create some data, and you know what you want to do with the data once it arrives, but the event hasn't happened yet.  What do you do?  You can register a function to be called once data is received.  This function is called a callback.  In <a href="#!/core/introduction">What is Twisted?</a>, we register a callback using the <code>setFunctionToBeCalledWhenThereIsData</code> method.
</p>


<h2>An object dedicated to registering callbacks</h2>

<p>
  To keep the reactor code small and focused, we can factor out the callback registration into an object dedicated to registering and calling callbacks.  It might look like this:
</p>

<pre class="prettyprint lang-py" include="./txftw/core/deferred1.py"></pre>

<p>
  Now we can hook into the reactor (from <a href="#!/core/introduction">What is Twisted?</a>) like this:
</p>

<pre class="prettyprint lang-py" include="./txftw/core/deferred2.py"></pre>

<p>
  Save that code in a file, run it, then send it some data with <code>nc</code>:
</p>

<pre class="prettyprint lang-bash">echo "foo" | nc 127.0.0.1 7777</pre>

<p>
  You should see <code>FOO</code> and then the server process ends.
</p>



<h2>Deferred</h2>

<p>
  In the Twisted library, the "object dedicated to registering callbacks" is <a href="http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html" target="_blank"><code>twisted.internet.defer.Deferred</code></a>.  It is similar to the <code>CallbackRegistry</code> above, but much more robust.  Twisted's <code>Deferred</code> supports cancellation, chaining, error-handling and more.
</p>

<p>
  Please note that <strong>Deferreds don't make code asynchronous.</strong>  The <em>reactor</em> does asynchronous things.  <code>Deferreds</code> are simply a convenience for keeping track of callback functions.
</p>


<h2>Next Steps</h2>

<p>
  <a href="http://twistedmatrix.com/documents/current/core/howto/defer-intro.html" target="_blank">Much</a> <a href="http://twistedmatrix.com/documents/current/core/howto/defer.html" target="_blank">has</a> <a href="http://iffycan.blogspot.com/2012/06/bite-sized-twisted-deferreds.html" target="_blank">been</a> <a href="http://krondo.com/?p=1682" target="_blank">written</a> about Deferreds; read some of those articles.  If you find yourself getting frustrated <a href="http://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html" target="_blank">the source</a> is the ultimate authority on what a <code>Deferred</code> is and what it isn't.
</p>